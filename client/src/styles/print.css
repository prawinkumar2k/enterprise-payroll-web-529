/**
 * GLOBAL PRINT SYSTEM - PAYROLL ERP
 * Fixes all print alignment, table layout, and A4 formatting issues
 * Applies to ALL reports: Pay Bill, Abstracts, Bank Statement, Certificates, etc.
 */

/* ================================================
   1. A4 PAGE CONTROL (CRITICAL)
   ================================================ */
@page {
    size: A4 portrait;
    margin: 12mm;
}

@page :first {
    margin-top: 10mm;
}

/* Force A4 dimensions */
.print-page {
    width: 210mm;
    min-height: 297mm;
    margin: 0 auto;
    background: white;
    page-break-after: always;
    position: relative;
}

.print-container {
    width: 100%;
    max-width: 210mm;
    margin: 0 auto;
    padding: 0;
    background: white;
}

/* ================================================
   2. PRINT-ONLY CSS RESET
   ================================================ */
@media print {
    * {
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
        accent-color: exact !important;
    }

    html,
    body {
        width: 210mm;
        height: 297mm;
        margin: 0 !important;
        padding: 0 !important;
        background: white !important;
        overflow: visible !important;
        zoom: 100% !important;
        -webkit-transform: scale(1) !important;
        transform: scale(1) !important;
    }

    body {
        font-family: 'Arial', 'Helvetica', sans-serif !important;
        font-size: 11pt !important;
        line-height: 1.3 !important;
    }

    * {
        box-sizing: border-box !important;
        overflow: visible !important;
    }

    /* Remove all screen layout constraints */
    .container,
    .wrapper,
    main {
        width: 100% !important;
        max-width: none !important;
        margin: 0 !important;
        padding: 0 !important;
        display: block !important;
    }
}

/* ================================================
   3. HIDE SCREEN ELEMENTS DURING PRINT
   ================================================ */
@media print {

    /* Hide navigation and UI elements */
    nav,
    .sidebar,
    .navbar,
    .menu,
    .header,
    .footer,
    .btn,
    button,
    .no-print,
    .print-hide,
    .toolbar,
    .controls,
    [class*="sidebar"],
    [class*="navbar"],
    [class*="menu"],
    [class*="toolbar"] {
        display: none !important;
        visibility: hidden !important;
        opacity: 0 !important;
        height: 0 !important;
        width: 0 !important;
        margin: 0 !important;
        padding: 0 !important;
    }

    /* Show only print content */
    .print-only,
    .print-show {
        display: block !important;
        visibility: visible !important;
    }
}

/* ================================================
   4. TABLE LAYOUT FIX (MAIN ISSUE)
   ================================================ */
@media print {
    table {
        width: 100% !important;
        max-width: 100% !important;
        border-collapse: collapse !important;
        table-layout: fixed !important;
        margin: 0 !important;
        page-break-inside: auto !important;
        font-size: 9pt !important;
    }

    /* Specific table classes */
    .print-table,
    .print-abstract-table,
    .report-table {
        width: 100% !important;
        border-collapse: collapse !important;
        table-layout: fixed !important;
    }

    thead {
        display: table-header-group !important;
        page-break-inside: avoid !important;
        page-break-after: avoid !important;
    }

    tbody {
        display: table-row-group !important;
    }

    tfoot {
        display: table-footer-group !important;
        page-break-inside: avoid !important;
    }

    tr {
        page-break-inside: avoid !important;
        page-break-after: auto !important;
    }

    th,
    td {
        border: 1px solid #000 !important;
        padding: 3px 4px !important;
        font-size: 9pt !important;
        text-align: center !important;
        vertical-align: middle !important;
        white-space: normal !important;
        word-break: break-word !important;
        overflow: visible !important;
        /* CRITICAL: NO rotation or transform */
        writing-mode: horizontal-tb !important;
        transform: none !important;
    }

    th {
        background-color: #f0f0f0 !important;
        font-weight: bold !important;
        font-size: 9pt !important;
    }

    /* Text alignment helpers */
    .text-left {
        text-align: left !important;
    }

    .text-right {
        text-align: right !important;
    }

    .text-center {
        text-align: center !important;
    }
}

/* ================================================
   5. HEADER ALIGNMENT STANDARD
   ================================================ */
@media print {
    .print-header {
        width: 100% !important;
        text-align: center !important;
        margin-bottom: 10mm !important;
        page-break-inside: avoid !important;
    }

    .print-header img,
    .print-logo {
        max-width: 60px !important;
        max-height: 60px !important;
        display: block !important;
        margin: 0 auto 5mm !important;
    }

    .print-title,
    .report-title {
        font-size: 14pt !important;
        font-weight: bold !important;
        text-align: center !important;
        margin: 3mm 0 !important;
        text-transform: uppercase !important;
    }

    .print-subtitle,
    .report-subtitle {
        font-size: 11pt !important;
        text-align: center !important;
        margin: 2mm 0 !important;
    }

    .college-name,
    .institution-name {
        font-size: 16pt !important;
        font-weight: bold !important;
        text-align: center !important;
        margin: 2mm 0 !important;
    }

    .college-address,
    .institution-address {
        font-size: 10pt !important;
        text-align: center !important;
        margin: 1mm 0 3mm !important;
    }
}

/* ================================================
   6. PAGE BREAK SAFETY
   ================================================ */
@media print {
    .page-break {
        page-break-before: always !important;
        break-before: page !important;
    }

    .page-break-after {
        page-break-after: always !important;
        break-after: page !important;
    }

    .no-page-break {
        page-break-inside: avoid !important;
        break-inside: avoid !important;
    }

    .keep-together {
        page-break-inside: avoid !important;
    }

    /* Avoid breaking these elements */
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        page-break-after: avoid !important;
        page-break-inside: avoid !important;
    }

    img {
        page-break-inside: avoid !important;
    }
}

/* ================================================
   7. LANDSCAPE ORIENTATION SUPPORT
   ================================================ */
@media print {
    .print-landscape {
        width: 297mm !important;
        height: 210mm !important;
    }

    @page landscape {
        size: A4 landscape;
        margin: 12mm;
    }
}

/* ================================================
   8. SIGNATURE SECTION
   ================================================ */
@media print {
    .signature-section {
        margin-top: 15mm !important;
        page-break-inside: avoid !important;
    }

    .signature-box {
        display: inline-block !important;
        width: 45% !important;
        text-align: center !important;
        margin: 5mm 2% !important;
    }

    .signature-line {
        border-top: 1px solid #000 !important;
        margin-top: 15mm !important;
        padding-top: 2mm !important;
    }
}

/* ================================================
   9. FOOTER / TOTALS
   ================================================ */
@media print {

    .print-footer,
    .totals-section {
        margin-top: 5mm !important;
        page-break-inside: avoid !important;
        font-weight: bold !important;
    }

    .grand-total {
        font-size: 11pt !important;
        font-weight: bold !important;
        background-color: #f0f0f0 !important;
    }
}

/* ================================================
   10. SCREEN PREVIEW (OPTIONAL)
   ================================================ */
@media screen {
    .print-preview {
        width: 210mm;
        min-height: 297mm;
        margin: 20px auto;
        padding: 12mm;
        background: white;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    .print-preview-landscape {
        width: 297mm;
        height: 210mm;
    }
}

/* ================================================
   11. BROWSER-SPECIFIC FIXES
   ================================================ */
@media print {
    /* Chrome/Edge fix */
    @supports (-webkit-appearance: none) {
        body {
            zoom: 1 !important;
        }
    }

    /* Firefox fix */
    @-moz-document url-prefix() {
        body {
            transform: scale(1) !important;
        }
    }
}

/* ================================================
   12. UTILITY CLASSES
   ================================================ */
@media print {
    .font-bold {
        font-weight: bold !important;
    }

    .font-normal {
        font-weight: normal !important;
    }

    .uppercase {
        text-transform: uppercase !important;
    }

    .underline {
        text-decoration: underline !important;
    }

    .border-top {
        border-top: 2px solid #000 !important;
    }

    .border-bottom {
        border-bottom: 2px solid #000 !important;
    }

    .mt-1 {
        margin-top: 2mm !important;
    }

    .mt-2 {
        margin-top: 4mm !important;
    }

    .mt-3 {
        margin-top: 6mm !important;
    }

    .mb-1 {
        margin-bottom: 2mm !important;
    }

    .mb-2 {
        margin-bottom: 4mm !important;
    }

    .mb-3 {
        margin-bottom: 6mm !important;
    }
}